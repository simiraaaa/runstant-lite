//- 
extends ./layout

block content
  link(rel='stylesheet', href='/styles/list.css')

  header
    nav.blue-grey.darken-3
      div.row
        div.col.s12
          a(href='/').brand-logo
            img(src='/images/runstant.png')
            span Run
            span.lighter stant
          ul.right.social-nav.hide-on-small-and-down
            li.tweet-btn.
              <a href="https://twitter.com/share" class="twitter-share-button" data-via="phi_jp" data-hashtags="runstant">Tweet</a>
              <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            li.hatebu-btn.
              <a href="http://b.hatena.ne.jp/entry/http://lite.runstant.com/collections/#{title}" class="hatena-bookmark-button" data-hatena-bookmark-title="Runstant" data-hatena-bookmark-layout="standard-noballoon" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
            li.pocket-btn-temp.
              <a data-pocket-label="pocket" data-pocket-count="none" class="pocket-btn" data-lang="en"></a>
              <script type="text/javascript">!function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");</script>

          a.button-collapse.hide-on-large-only(href='', data-activates="nav-mobile")
            i.mdi-navigation-menu
    div.nav-wrapper
      ul#nav-mobile.side-nav.fixed
        each category in json
          li.category.opened
            a(href='') #{category.title}
              span.badge
                i.material-icons keyboard_arrow_down
            ul
              each sample in category.samples
                if sample.visible !== false
                  li.sample
                    a(href='#{sample.url}', target='preview', data-path='#{category.title}/#{sample.title}') #{sample.title}
        li.advertising.
          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
          <!-- Runstant -->
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-1611962793956940"
               data-ad-slot="1233189315"
               data-ad-format="auto"></ins>
          <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
          </script>


  main.main
    iframe.preview(name='preview')

  script.
    $(function() {
      $(".button-collapse").sideNav({
        menuWidth: 240,
      });

      $('li.category>a').click(function() {
        var elm = $(this);
        elm.parent().toggleClass('opened');
        return false;
      });

      $('li.sample>a').click(function() {
        openFromAnchor($(this));

        $(".button-collapse").sideNav('hide');
      });

      // 
      var hash = location.hash.substr(1);
      hash = decodeURIComponent(hash);
      var target = $('[data-path="'+ hash +'"]');
      openFromAnchor(target);
    });

    var openFromAnchor = function(a) {
      // opne preview
      var href = a.attr('href');
      if (!href) {
        href = $('.sample a')[0].href;
      }

      $('.preview').attr('src', href);

      // setup hash
      var path = a.data('path');
      if (path) {
        path = encodeURIComponent(path);
        location.hash = path || '';

        // add class
        $('li.sample').removeClass('active');
        a.parent().addClass('active');
      }
    };













